<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:th="http://www.thymeleaf.org"
	  xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<!--<html xmlns="http://www.w3.org/1999/xhtml">-->
<head>
	<title>汽车配件查询网</title>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" type="image/x-icon" href="../images/favicon.png"/>
	<link rel="stylesheet" href="../css/bootstrap.min.css">
	<link rel="stylesheet" href="../css/font-awesome.min.css">
	<link rel="stylesheet" href="../css/owl.carousel.min.css">
	<link rel="stylesheet" href="../css/animate.min.css">
	<link rel="stylesheet" href="../css/jquery-ui.css">
	<link rel="stylesheet" href="../css/slick.css">
	<link rel="stylesheet" href="../css/chosen.min.css">
	<link rel="stylesheet" href="../css/pe-icon-7-stroke.css">
	<link rel="stylesheet" href="../css/magnific-popup.min.css">
	<link rel="stylesheet" href="../css/lightbox.min.css">
	<link rel="stylesheet" href="../js/fancybox/source/jquery.fancybox.css">
	<link rel="stylesheet" href="../css/jquery.scrollbar.min.css">
	<link rel="stylesheet" href="../css/mobile-menu.css">
	<link rel="stylesheet" href="../fonts/flaticon/flaticon.css">
	<link rel="stylesheet" href="../css/style.css">
</head>
<body class="productsgrid-page">
	<header class="header style7">
	<div class="top-bar">
		<div class="container">
			<div class="top-bar-left">
				<div class="header-message">
					欢迎！
				</div>
			</div>
			<div class="top-bar-right">
				<ul class="header-user-links">
					<li>
						<div sec:authorize="!isAuthenticated()">
							您好,<a href="/login-view"><span style="color:red">请登录</span></a>
							<a href="/logout" title="退出">退出</a>
						</div>
						<!--您好,<a href="#"><span style="color:red" sec:authentication="name"></span></a>-->
						<div sec:authorize="isAuthenticated()">
							您好,<a href="#"><span style="color:red" sec:authentication="name"></span></a>
							<a href="/logout" title="退出">退出</a>
						</div>

					</li>
				</ul>
			</div>
		</div>
	</div>
	<div class="container">
		<div class="main-header">
			<div class="row">
				<div class="col-lg-3 col-sm-4 col-md-3 col-xs-7 col-ts-12 header-element">
					<div class="logo">
						<a href="index.html">
							<img src="../images/logo.png" alt="img">
						</a>
					</div>
				</div>
				<div class="col-lg-7 col-sm-8 col-md-6 col-xs-5 col-ts-12">
					<div class="block-search-block">
						<form class="form-search form-search-width-category">
							<div class="form-content">
								<!--<div class="category">
									<select title="cate" data-placeholder="All Categories" class="chosen-select"
											tabindex="1">
										<option value="United States">Accessories</option>
										<option value="United Kingdom">Clothing</option>
										<option value="Afghanistan">Beard Oil</option>
										<option value="Aland Islands">Spray Bottle</option>
										<option value="Albania">New Arrivals</option>
										<option value="Algeria">Storage</option>
									</select>
								</div>-->
								<div class="inner">
									<input id="queryString" type="text" class="input" name="s" value="" placeholder="请输入商品编号，商品名称，车型等关键字">
								</div>
								<button id="searchButton" class="btn-search" type="button">
									<span class="icon-search"></span>
								</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="header-nav-container">
		<div class="container">
			<div class="header-nav-wapper main-menu-wapper">

				<div class="header-nav">
					<div class="container-wapper">
						<ul class="emeriss-clone-mobile-menu emeriss-nav main-menu" id="menu-main-menu">
							<li class="menu-item">
								<a href="/index" class="emeriss-menu-item-title" title="Home">首页</a>
							</li>
							<li class="menu-item">
								<a href="/hinges" class="emeriss-menu-item-title" title="Home">合叶</a>
							</li>
							<li class="menu-item">
								<a href="#" class="emeriss-menu-item-title" title="About">关于我们</a>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
</header>
	<div class="main-content main-content-product no-sidebar">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<div class="breadcrumb-trail breadcrumbs">
						<ul class="trail-items breadcrumb">
							<li class="trail-item trail-begin">
								<a href="index.html">首页</a>
							</li>
							<li class="trail-item trail-end active">
								配件查询
							</li>
						</ul>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="content-area shop-grid-content full-width col-lg-12 col-md-12 col-sm-12 col-xs-12">
					<div class="site-main">
						<h3 class="custom_blog_title">
							查询结果
						</h3>
						<table width="1180px" style="table-layout: fixed;">
							<thead>
							<tr style="">
								<th style="width:130px;text-align:center;vertical-align:middle;">商品编号</th>
								<th style="width:130px;text-align:center;vertical-align:middle;">商品名称</th>
								<th style="width:130px;text-align:center;vertical-align:middle;">车型</th>
								<!--<th style="width:130px;text-align:center;vertical-align:middle;">批发价格(单位：元)</th>-->
								<th style="width:130px;text-align:center;vertical-align:middle;">零售价格(单位：元)</th>
								<!--<th style="width:130px;text-align:center;vertical-align:middle;">优惠价格(单位：元)</th>-->
								<th style="width:130px;text-align:center;vertical-align:middle;">厂家编号</th>
								<th style="width:130px;text-align:center;vertical-align:middle;">规格</th>
							</tr>
							</thead>
							<tbody id = "autoPartsTable">
							<!-- 后台数据-->
							</tbody>
						</table>

						<div class="pagination clearfix style2" >
							<div class="nav-link" id="editable_paginate">
								<!--<a href="#" class="page-numbers"><i class="icon fa fa-angle-left" aria-hidden="true"></i></a>
								<a href="#" class="page-numbers">1</a>
								<a href="#" class="page-numbers">2</a>
								<a href="#" class="page-numbers current">3</a>
								<a href="#" class="page-numbers"><i class="icon fa fa-angle-right" aria-hidden="true"></i></a>-->
							</div>
						</div>
					</div>
				</div>
				<div class="sidebar col-lg-3 col-md-3 col-sm-12 col-xs-12">
					<div class="wrapper-sidebar shop-sidebar">
						<div class="widget woof_Widget">
							<div class="widget widget-categories">
								<h3 class="widgettitle">Categories</h3>
								<ul class="list-categories">
									<li>
										<input type="checkbox" id="cb1">
										<label for="cb1" class="label-text">
											New Arrivals
										</label>
									</li>
									<li>
										<input type="checkbox" id="cb2">
										<label for="cb2" class="label-text">
											Grooming
										</label>
									</li>
									<li>
										<input type="checkbox" id="cb3">
										<label for="cb3" class="label-text">
											Beard Oil
										</label>
									</li>
									<li>
										<input type="checkbox" id="cb4">
										<label for="cb4" class="label-text">
											Clothing
										</label>
									</li>
									<li>
										<input type="checkbox" id="cb5">
										<label for="cb5" class="label-text">
											Accessories
										</label>
									</li>
									<li>
										<input type="checkbox" id="cb6">
										<label for="cb6" class="label-text">
											Backpack
										</label>
									</li>
								</ul>
							</div>
							<div class="widget widget_filter_price">
								<h4 class="widgettitle">
									Price
								</h4>
								<div class="price-slider-wrapper">
		                    		<div data-label-reasult="Range:" data-min="0" data-max="3000" data-unit="$" class="slider-range-price " data-value-min="0" data-value-max="1000">	
		                    		</div>
		                    		<div class="price-slider-amount">
			                            <span class="from">$45</span>
			                            <span class="to">$215</span>
			                        </div>
								</div>
							</div>
							<div class="widget widget-brand">
								<h3 class="widgettitle">Brand</h3>
								<ul class="list-brand">
									<li>
										<input id="cb7" type="checkbox">
										<label for="cb7" class="label-text">New Arrivals</label>
									</li>
									<li>
										<input id="cb8" type="checkbox">
										<label for="cb8" class="label-text">Grooming</label>
									</li>
									<li>
										<input id="cb9" type="checkbox">
										<label for="cb9" class="label-text">Beard Oil</label>
									</li>
									<li>
										<input id="cb10" type="checkbox">
										<label for="cb10" class="label-text">Clothing</label>
									</li>
									<li>
										<input id="cb11" type="checkbox">
										<label for="cb11" class="label-text">Accessories</label>
									</li>
									<li>
										<input id="cb12" type="checkbox">
										<label for="cb12" class="label-text">Backpack</label>
									</li>
								</ul>
							</div>
							<div class="widget widget_filter_size">
								<h4 class="widgettitle">Size</h4>
								<ul class="list-size">
									<li>
										<a href="#">xs</a>
									</li>
									<li>
										<a href="#">s</a>
									</li>
									<li class="active">
										<a href="#">m</a>
									</li>
									<li>
										<a href="#">l</a>
									</li>
									<li>
										<a href="#">xl</a>
									</li>
									<li>
										<a href="#">xxl</a>
									</li>
								</ul>
							</div>
							<div class="widget widget-color">
								<h4 class="widgettitle">
									Color
								</h4>
								<div class="list-color">
									<a href="#" class="color1"></a>
									<a href="#" class="color2 "></a>
									<a href="#" class="color3 active"></a>
									<a href="#" class="color4"></a>
									<a href="#" class="color5"></a>
									<a href="#" class="color6"></a>
									<a href="#" class="color7"></a>
								</div>
							</div>
							<div class="widget widget-tags">
								<h3 class="widgettitle">
									Popular Tags
								</h3>
								<ul class="tagcloud">
									<li class="tag-cloud-link">
										<a href="#">Fashion</a>
									</li>
									<li class="tag-cloud-link">
										<a href="#">Clothing</a>
									</li>
									<li class="tag-cloud-link">
										<a href="#">Backpack</a>
									</li>
									<li class="tag-cloud-link active">
										<a href="#">Accessories</a>
									</li>
									<li class="tag-cloud-link">
										<a href="#">Hot</a>
									</li>
									<li class="tag-cloud-link">
										<a href="#">Backpack</a>
									</li>
									<li class="tag-cloud-link">
										<a href="#">Grooming</a>
									</li>
								</ul>
							</div>
						</div>
						<div class="widget newsletter-widget">
							<div class="newsletter-form-wrap ">
								<h3 class="title">Subscribe to Our Newsletter</h3>
								<div class="subtitle">
									More special Deals, Events & Promotions
								</div>
								<input type="email" class="email" placeholder="Your email letter">
								<button type="submit" class="button submit-newsletter">Subscribe</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<footer class="footer style7">
		<div class="container">
			<div class="container-wapper">
				<div class="row">
					<div class="box-footer col-xs-12 col-sm-6 col-md-6 col-lg-4">
						<div class="widget-box">
							<div class="single-img">
								<a href="index.html"><img src="../images/logo-light.png" alt="img"></a>
							</div>
							<ul class="menu">
								<li class="menu-item">
									<a href="#"><span class="flaticon-placeholder"></span>45 Grand Central Terminal New
										York,NY 1017 United State USA</a>
								</li>
								<li class="menu-item">
									<a href="#"><span class="fa fa-phone"></span>(+123) 456 789 - (+123) 666 888</a>
								</li>
								<li class="menu-item">
									<a href="#"><span class="fa fa-envelope-o"></span>Contact@yourcompany.com</a>
								</li>
								<li class="menu-item">
									<a href="#"><span class="flaticon-clock"></span>Mon-Sat 9:00pm - 5:00pm Sun : Closed</a>
								</li>
							</ul>
						</div>
					</div>
					<div class="box-footer col-xs-12 col-sm-6 col-md-6 col-lg-2">
						<div class="emeriss-custommenu default">
							<h2 class="widgettitle">Quick Menu</h2>
							<ul class="menu">
								<li class="menu-item">
									<a href="#">New arrivals</a>
								</li>
								<li class="menu-item">
									<a href="#">Life style</a>
								</li>
								<li class="menu-item">
									<a href="#">Clothing</a>
								</li>
								<li class="menu-item">
									<a href="#">Backpack</a>
								</li>
								<li class="menu-item">
									<a href="#">Grooming</a>
								</li>
							</ul>
						</div>
					</div>
					<div class="box-footer col-xs-12 col-sm-6 col-md-6 col-lg-2">
						<div class="emeriss-custommenu default">
							<h2 class="widgettitle">Information</h2>
							<ul class="menu">
								<li class="menu-item">
									<a href="#">FAQs</a>
								</li>
								<li class="menu-item">
									<a href="#">Track Order</a>
								</li>
								<li class="menu-item">
									<a href="#">Delivery</a>
								</li>
								<li class="menu-item">
									<a href="#">Contact Us</a>
								</li>
								<li class="menu-item">
									<a href="#">Return</a>
								</li>
							</ul>
						</div>
					</div>
					<div class="box-footer col-xs-12 col-sm-6 col-md-6 col-lg-4">
						<div class="emeriss-newsletter style1">
							<div class="newsletter-head">
								<h3 class="title">Newsletter</h3>
							</div>
							<div class="newsletter-form-wrap">
								<div class="list">
									Get notified of new products, limited releases, and more.
								</div>
								<input type="email" class="input-text email email-newsletter"
									   placeholder="Your email letter">
								<button class="button btn-submit submit-newsletter">SUBSCRIBE</button>
							</div>
						</div>
						<div class="emeriss-socials">
							<ul class="socials">
								<li>
									<a href="#" class="social-item" target="_blank">
										<i class="icon fa fa-facebook"></i>
									</a>
								</li>
								<li>
									<a href="#" class="social-item" target="_blank">
										<i class="icon fa fa-twitter"></i>
									</a>
								</li>
								<li>
									<a href="#" class="social-item" target="_blank">
										<i class="icon fa fa-instagram"></i>
									</a>
								</li>
							</ul>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-sm-12 border-custom">
						<span></span>
					</div>
				</div>
				<div class="footer-end">
					<div class="row">
						<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
							<div class="coppyright">
								Copyright © 2020
								<a href="#">Emeriss</a>
								. All rights reserved
							</div>
						</div>
						<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
							<div class="emeriss-payment">
								<img src="../images/payments.png" alt="img">
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</footer>
	<div class="footer-device-mobile">
		<div class="wapper">
			<div class="footer-device-mobile-item device-home">
				<a href="index.html">
					<span class="icon">
						<i class="fa fa-home" aria-hidden="true"></i>
					</span>
					Home
				</a>
			</div>
			<div class="footer-device-mobile-item device-home device-wishlist">
				<a href="#">
					<span class="icon">
						<i class="fa fa-heart" aria-hidden="true"></i>
					</span>
					Wishlist
				</a>
			</div>
			<div class="footer-device-mobile-item device-home device-cart">
				<a href="#">
					<span class="icon">
						<i class="fa fa-shopping-basket" aria-hidden="true"></i>
						<span class="count-icon">
							0
						</span>
					</span>
					<span class="text">Cart</span>
				</a>
			</div>
			<div class="footer-device-mobile-item device-home device-user">
				<a href="#">
					<span class="icon">
						<i class="fa fa-user" aria-hidden="true"></i>
					</span>
					Account
				</a>
			</div>
		</div>
	</div>
	<a href="#" class="backtotop">
		<i class="fa fa-angle-double-up"></i>
	</a>

	<script src="../js/jquery-1.12.4.min.js"></script>
	<script src="../js/jquery.plugin-countdown.min.js"></script>
	<script src="../js/jquery-countdown.min.js"></script>
	<script src="../js/bootstrap.min.js"></script>
	<script src="../js/owl.carousel.min.js"></script>
	<script src="../js/magnific-popup.min.js"></script>
	<script src="../js/isotope.min.js"></script>
	<script src="../js/jquery.scrollbar.min.js"></script>
	<script src="../js/jquery-ui.min.js"></script>
	<script src="../js/mobile-menu.js"></script>
	<script src="../js/chosen.min.js"></script>
	<script src="../js/slick.js"></script>
	<script src="../js/jquery.elevateZoom.min.js"></script>
	<script src="../js/jquery.actual.min.js"></script>
	<script src="../js/fancybox/source/jquery.fancybox.js"></script>
	<script src="../js/lightbox.min.js"></script>
	<script src="../js/owl.thumbs.min.js"></script>
	<script src="../js/jquery.scrollbar.min.js"></script>
	<script src="../js/frontend-plugin.js"></script>
	<script>
		$(function() {
			autoPartList(1);
		});

		function autoPartList(currentPage){
			var queryString = $("#queryString").val();
			var param = {currentPage:currentPage,queryString:queryString};
			console.log(JSON.stringify(param));
			$.ajax({
				type:"POST",
				data:JSON.stringify(param),
				url:"/autoPartsInfo/list",
				contentType:"application/json",
				dataType:"json",
				success:function(data){
					$("#autoPartsTable").empty();
					$("#totalPageUl").empty();
					//总数
					var total = data.data.total;
					//总页数
					var totalPageNums = Math.ceil(total/20);
					//两侧显示的页码数 大于1
					var edges = 2;
					//主页码区显示的页码数 大于3
					var playes = 5;
					if(total==0){
						$('#editable_paginate').empty();
					}else{
						renderPageItem(totalPageNums,playes,edges,currentPage);
					}

					$.each(data.data.autoPartsList, function(i,item){
						$tr = $('<tr></tr>');
						$td1 = $('<td style="text-align:center;vertical-align:middle;">'+item.productNumber+'</td>');
						$td2 = $('<td style="text-align:center;vertical-align:middle;">'+item.productName+'</td>');
						$td3 = $('<td style="text-align:center;vertical-align:middle;">'+item.vehicleModel+'</td>');
						//$td4 = $('<td style="text-align:center;vertical-align:middle;">'+item.wholesalePrice+'</td>');
						//$td5 = $('<td style="text-align:center;vertical-align:middle;">'+item.retailPrice+'</td>');
						$td5 = $('<td id="retailPricetd'+item.id+'" style="text-align:center;vertical-align:middle;"><a id="priceStr'+item.id+'" style="color:dodgerblue;" href="javascript:queryPrice('+item.id+','+item.retailPrice+')">查看价格</a></td>');
						//$td5_show_price = $('<td style="text-align:center;vertical-align:middle;">'+item.retailPrice+'</td>');
						//$td6 = $('<td style="text-align:center;vertical-align:middle;">'+item.discountPrice+'</td>');
						$td7 = $('<td style="text-align:center;vertical-align:middle;">'+item.factoryNumber+'</td>');
						$td7Null = $('<td style="text-align:center;vertical-align:middle;"></td>');
						$td8 = $('<td style="text-align:center;vertical-align:middle;">'+item.specification+'</td>');
						$td8Null = $('<td style="text-align:center;vertical-align:middle;"></td>');

						$tr.append($td1);
						$tr.append($td2);
						$tr.append($td3);
						//$tr.append($td4);
						$tr.append($td5);
						//$tr.append($td6);
						if(item.factoryNumber==undefined){
							$tr.append($td7Null);
						}else{
							$tr.append($td7);
						}
						if(item.specification==undefined){
							$tr.append($td8Null);
						}else {
							$tr.append($td8);
						}
						$('#autoPartsTable').append($tr);
					});
				}
			});
		}

		function renderPageItem(totalPageNums,playes,edges,currentPage) {
			//debugger;
			$ul = $('<ul class="pagination pull-right" style="margin:-3px 0;">');
			var start = 1;
			var end = totalPageNums;
			if(playes % 2){
				//playes是奇数
				start = currentPage - Math.floor(playes / 2);
				end = currentPage + Math.floor(playes / 2);
			}else{
				//playes是偶数
				start = currentPage - (playes / 2 - 1);
				end = currentPage + playes / 2;
			}
			if (start <= edges + 1) {
				start = 1;
				if (end < playes && playes<totalPageNums) {
					end = playes;
				}
			}else{
				for (var i = 1; i <= edges; i++) {
					$ul.append(renderItem(i,currentPage));
				}
				$ul.append('<span>...</span>');
			}
			if (end < totalPageNums - edges) {
				for (var i = start; i <= end; i++) {
					$ul.append(renderItem(i,currentPage));
				}
				$ul.append('<span>...</span>');
				for (var i = totalPageNums - edges + 1; i <= totalPageNums; i++) {
					$ul.append(renderItem(i,currentPage));
				}
			}else{
				end = totalPageNums;
				/*if(start>totalPageNums-playes+1){
                    start = totalPageNums-playes+1
                }*/
				for (var i = start; i <= end; i++) {
					$ul.append(renderItem(i));
				}
			}
			$ul.prepend(renderPrevItem(currentPage));
			$ul.append(renderNextItem(currentPage,totalPageNums));
			$('#editable_paginate').empty().append($ul);
		}

		function renderItem(i,currentPage) {
			//debugger;
			$item = $('<a href="javascript:autoPartList('+i+')">'+i+'</a>');
			if (i == currentPage) {
				$item.addClass('page-numbers current');
			}else{
				$item.addClass('page-numbers');
			}
			$item.on('click', (function (num) {
				return function () {
					currentPage = num;
					renderPageItem(currentPage);
				}
			})(i));
			return $item;
		}

		function renderPrevItem(currentPage) {
			//debugger;
			$prev = $('<a href="javascript:autoPartList('+currentPage+')" class="page-numbers"><i class="icon fa fa-angle-left" aria-hidden="true"></i>');
			if (currentPage == 1) {
				$prev.addClass('disabled');
			} else {
				$prev.on('click', function () {
					currentPage = currentPage - 1;
					renderPageItem(currentPage);
				})
			}
			return $prev;
		}

		function renderNextItem(currentPage,totalPageNums) {
			//debugger;
			$next = $('<a href="javascript:autoPartList('+currentPage+')" class="page-numbers"><i class="icon fa fa-angle-right" aria-hidden="true"></i></a>');
			if (currentPage == totalPageNums) {
				$next.addClass('disabled');
			} else {
				$next.on('click', function () {
					currentPage = currentPage + 1;
					renderPageItem(currentPage);
				})
			}
			return $next;
		}

		$("#searchButton").click(function () {
			$('#editable_paginate').empty();
			autoPartList(1);
		})

		$("#queryString").keypress(function (e) {
			if (e.which == 13) {
				autoPartList(1);
				return false;
			}
		});

		function queryPrice(partsId,price){
			var param = {partsId:partsId,price:price};
			$.ajax({
				type:"POST",
				data:JSON.stringify(param),
				url:"/carParts/createPartsNeed",
				contentType:"application/json",
				dataType:"json",
				success:function(data){
					console.log(data);
					if(data.code==200){
						$('#retailPricetd'+partsId).append(price);
						$('#priceStr'+partsId).empty();
					}
				},
				error:function(e){
					window.location.href="/login-view";
					console.log(e);
				}

			});
		}
		/*<a href="javascript:autoPartList('+currentPage+')" class="page-numbers"><i class="icon fa fa-angle-left" aria-hidden="true"></i></a>
		<a href="#" class="page-numbers">1</a>
				<a href="#" class="page-numbers">2</a>
				<a href="#" class="page-numbers current">3</a>
				<a href="#" class="page-numbers"><i class="icon fa fa-angle-right" aria-hidden="true"></i></a>

		<li class="paginate_button previous" ><a href="javascript:autoPartList('+i+')">'+i+'</a></li>*/
	</script>
</body>
</html>